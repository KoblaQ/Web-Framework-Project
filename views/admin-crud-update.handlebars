{{!-- CSS was hardcoded here --}}
<link rel="stylesheet" href="/style.css"/>


{{>header}}
<div class="admin-page-container">
    <h1>ADMIN PAGE for {{companyName}} (views/admin-crud-update.handlebars) update + delete button with alert window
    </h1>
    <h2>You can change the data of the user {{products.userID}} here:</h2>
    <div class="admin-edit-container">

        {{!-- getting one user from mongodb --}}
        <div>
            <p><strong>User ID: </strong>{{products.userID}}</p>
            <p><strong>Name: </strong>{{products.firstName}} {{products.lastName}}</p>
            <p><strong>Email: </strong>{{products.email}}</p>
            <p><strong>Phone: </strong>{{products.phoneNumber}}</p>
            <p><strong>Check-In Date: </strong>{{products.checkIn}}</p>
            <p><strong>Check-Out Date: </strong>{{products.checkOut}}</p>
        </div>

        {{!-- update user data --}}
        <form action="/adminpage" method="POST" autocomplete="off">

            <input type="hidden" name="userID" value="{{products.userID}}">

            <div class="new-checkIn">
                <p>New Check-In Date:</p>
                <input class="checkIn field" id="new-checkIn" placeholder="New Check-In" name="checkIn"
                    type="new-checkIn" value="{{products.checkIn}}" title="">
            </div>

            <div class="new-checkOut">
                <p>New Check-Out Date:</p>
                <input class="checkOut field" id="new-checkOut" placeholder="New Check-Out" name="checkOut"
                    type="new-checkOut" value="{{products.checkOut}}" title="">
            </div>

            <button class="delete-button" href="/adminpage" onclick="confirmDelete({{products.userID}})">Delete</button>
            <button class="update-button" type="submit">Update User</button>
        </form>

    </div>
    <br>
    <a class="continue-button" href="/adminpage">Go Back</a>

        <script>
            function confirmDelete(userID) {
                if (confirm("Are you sure you want to delete this reservation?")) {
                    fetch(`/admin-crud-update/delete/${userID}`, {
                    method: "GET", // Use POST method as method-override is enabled
                    })
                    .then((response) => {
                        if (response.ok) {
                        console.log("User deleted successfully");
                        location.reload(); // Reload the page after successful deletion
                        } else {
                        throw new Error("Failed to delete user");
                        }
                    })
                    .catch((error) => {
                        console.error(error);
                        alert("Failed to delete user");
                    });
                } else {
                    console.log("Reservation was not deleted");
                }
                }

        </script>

</div>
{{>footer}}
</body>
</html>